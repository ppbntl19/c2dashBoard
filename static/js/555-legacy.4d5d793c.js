"use strict";(self["webpackChunkc2_cms_admin"]=self["webpackChunkc2_cms_admin"]||[]).push([[555],{1613:function(t,e,n){n.d(e,{Z:function(){return x}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[n("el-form",{ref:"validateForm",attrs:{model:t.formData,rules:t.rules,"label-width":"140px"}},[n("el-form-item",{attrs:{label:"Name",prop:"name"}},[n("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"Route",prop:"route"}},[n("el-input",{model:{value:t.formData.route,callback:function(e){t.$set(t.formData,"route",e)},expression:"formData.route"}})],1),n("el-form-item",{attrs:{label:"Category",prop:"category"}},[n("el-select",{attrs:{placeholder:"please choose"},model:{value:t.formData.category,callback:function(e){t.$set(t.formData,"category",e)},expression:"formData.category"}},t._l(t.categoryList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),n("el-form-item",{attrs:{label:"Product Picture",prop:"pic"}},[n("el-upload",{attrs:{action:"","http-request":t.onUploadStart,"list-type":"picture-card",name:"upload","auto-upload":!0,"file-list":t.uploadFile.list,limit:t.uploadFile.limit,"on-success":t.onUploadChange,"on-remove":t.onRemoveChange,"on-exceed":t.onUploadExceed,drag:"",multiple:"",headers:t.uploadHeaders}},[n("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),n("el-form-item",{attrs:{label:"Home Recommended",prop:"recommend"}},[n("el-switch",{model:{value:t.formData.recommend,callback:function(e){t.$set(t.formData,"recommend",e)},expression:"formData.recommend"}}),t._v(" "+t._s(t.formData.recommend?"On":"Disable")+" ")],1),n("el-form-item",{attrs:{label:"Status",prop:"status"}},[n("el-switch",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}}),t._v(" "+t._s(t.formData.status?"On":"Disable")+" ")],1),n("el-form-item",{attrs:{label:"About(SEO)",prop:"intro"}},[n("el-input",{model:{value:t.formData.intro,callback:function(e){t.$set(t.formData,"intro",e)},expression:"formData.intro"}})],1),n("el-form-item",{attrs:{label:"Content",prop:"content"}},[n("ckeditor",{attrs:{editor:t.editor},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1)],1),n("div",{staticClass:"fixed--footer"},[n("el-button",{attrs:{type:"primary",id:"editor"},on:{click:function(e){return t.submitForm("validateForm")}}},[t._v("Submit")]),n("el-button",{on:{click:function(e){return t.resetForm("validateForm")}}},[t._v("Reset")])],1)],1)},a=[],o=(n(57658),n(41539),n(59940)),i=n(71787),u=n(65864),s=(n(42325),n(51836)),l=n(95334),c=n(82002),d=n.n(c),p=n(16480),f=(0,s.LP)(),m="Bearer ".concat(f),h=o.v.routePath,g={name:"ProductCreateUpdate",components:{},filters:{},props:{type:{type:String,default:function(){return"create"}}},data:function(){return{loading:!1,querys:{id:""},formData:{id:"",name:"",route:"",category:"",pic:"",recommend:!0,intro:"",content:"",status:!0,createdBy:this.$store.state.user.userInfo.id},rules:{name:[{required:!0,message:"Please enter a name",trigger:"blur"}],route:[{required:!0,message:"Please enter a Description(Slug URL)",trigger:"blur"},{min:1,max:100,message:"1 to 100 characters long",trigger:"blur"}],category:[{required:!0,message:"Please select a type",trigger:"change"}],pic:[{required:!0,message:"Please upload a picture",trigger:"change"}],content:[{required:!0,message:"Please enter details",trigger:"change"}]},categoryList:[],uploadHeaders:{Authorization:m},uploadFile:{list:[],limit:1},editor:d(),editorConfig:{htmlSupport:{allow:[{name:/.*/,attributes:!0,classes:!0,styles:!0,scripts:!0}]},extraPlugins:[v]}}},watch:{},created:function(){this.getQuery(),this.getCategoryList()},methods:{submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.loading=!0,"update"===e.type?e.putUpdate():e.postCreate()}))},resetForm:function(t){this.$refs[t].resetFields()},getQuery:function(){var t=this.$route.query||{};if(this.querys=t,"update"===this.type){if(!t.id)return void this.$router.push("list");this.getDetail()}},onChoiceCategory:function(t){console.log("onChoiceCategory",t)},onResetCategory:function(){this.formData.category=[]},onUploadChange:function(t){console.log(t),this.formData.pic=t.path},onUploadStart:function(t){var e=this;(0,l.I)(t.file,"banner","banner").then((function(t){e.formData.pic=t.url}))},onRemoveChange:function(t){t.response;this.uploadFile.list=[],this.formData.pic=""},onUploadExceed:function(){this.$message({message:"Exceeded upload quantity",type:"error"}),console.log("onUploadExceed")},postCreate:function(){var t=this;(0,i.Ue)(this.formData).then((function(){t.loading=!1,t.$message({message:"Congratulations, the operation was successful",type:"success",duration:1e3}),setTimeout((function(){t.$router.push("".concat(h,"list"))}),1e3)})).finally((function(){t.loading=!1}))},putUpdate:function(){var t=this;(0,i.Vx)(this.formData).then((function(){t.loading=!1,t.$message({message:"Congratulations, the operation was successful",type:"success",duration:1e3}),setTimeout((function(){t.$router.push("".concat(h,"list"))}),1e3)})).finally((function(){t.loading=!1}))},getDetail:function(){var t=this;this.loading=!0,(0,i.Nm)(this.querys.id).then((function(e){t.loading=!1;var n=e.pic;n&&n&&t.uploadFile.list.push({name:n,url:n}),t.formData=e})).finally((function(){t.loading=!1}))},getCategoryList:function(){var t=this;(0,u.mE)().then((function(e){t.categoryList=e.results||[]})).finally((function(){t.loading=!1}))}}};function v(t){t.plugins.get("FileRepository").createUploadAdapter=function(t){return new p.i(t,"home_about","C2_home_About")}}var y=g,b=n(1001),D=(0,b.Z)(y,r,a,!1,null,null,null),x=D.exports},20555:function(t,e,n){n.r(e),n.d(e,{default:function(){return c}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("create-update",{attrs:{type:t.type}})],1)},a=[],o=n(1613),i={name:"CreateAbout",components:{CreateUpdate:o.Z},data:function(){return{type:"create"}}},u=i,s=n(1001),l=(0,s.Z)(u,r,a,!1,null,null,null),c=l.exports},95334:function(t,e,n){n.d(e,{I:function(){return i}});var r=n(50124),a=n(48534),o=(n(92222),n(41539),n(42325)),i=function(){var t=(0,a.Z)((0,r.Z)().mark((function t(e,n,a){var i,u,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new FormData,i.append("upload_preset",o.nr),i.append("folder",a||"/content/articles"),i.append("tags",n||"browser_upload"),i.append("file",e),u="".concat(o.lQ,"/").concat(o.Ke,"/upload"),t.prev=6,t.next=9,fetch(u,{method:"POST",body:i});case 9:return s=t.sent,t.next=12,s.json();case 12:return t.abrupt("return",t.sent);case 15:return t.prev=15,t.t0=t["catch"](6),t.abrupt("return",console.error(t.t0));case 18:case"end":return t.stop()}}),t,null,[[6,15]])})));return function(e,n,r){return t.apply(this,arguments)}}()},65864:function(t,e,n){n.d(e,{Nm:function(){return u},Od:function(){return i},Ue:function(){return s},Vx:function(){return l},mE:function(){return o}});var r=n(84471),a="/product-categories/";function o(t){return(0,r.Z)({url:"".concat(a),method:"get",params:t})}function i(t){return(0,r.Z)({url:"".concat(a),method:"delete",data:t})}function u(t){return(0,r.Z)({url:"".concat(a+t),method:"get"})}function s(t){return(0,r.Z)({url:"".concat(a),method:"post",data:t})}function l(t){return(0,r.Z)({url:"".concat(a+t.id),method:"put",data:t})}},71787:function(t,e,n){n.d(e,{Nm:function(){return u},Od:function(){return i},Ue:function(){return s},Vx:function(){return l},mE:function(){return o}});var r=n(84471),a="/products/";function o(t){return(0,r.Z)({url:"".concat(a),method:"get",params:t})}function i(t){return(0,r.Z)({url:"".concat(a),method:"delete",data:t})}function u(t){return(0,r.Z)({url:"".concat(a+t),method:"get"})}function s(t){return(0,r.Z)({url:"".concat(a),method:"post",data:t})}function l(t){return(0,r.Z)({url:"".concat(a+t.id),method:"put",data:t})}},16480:function(t,e,n){n.d(e,{i:function(){return i}});var r=n(13087),a=n(62833),o=(n(41539),n(92222),n(68309),n(42325)),i=function(){function t(e,n,a,o){(0,r.Z)(this,t),this.loader=e,this.folder=n,this.tags=a,o&&(this.sizes=o)}return(0,a.Z)(t,[{key:"upload",value:function(){var t=this;return this.loader.file.then((function(e){return new Promise((function(n,r){t._initRequest(),t._initListeners(n,r,e),t._sendRequest(e)}))}))}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}},{key:"_initRequest",value:function(){var t=this.xhr=new XMLHttpRequest,e="".concat(o.lQ,"/").concat(o.Ke,"/upload");t.open("POST",e,!0),t.responseType="json"}},{key:"_initListeners",value:function(t,e,n){var r=this.xhr,a=this.loader,o="Couldn't upload file: ".concat(n.name,".");r.addEventListener("error",(function(){return e(o)})),r.addEventListener("abort",(function(){return e()})),r.addEventListener("load",(function(){var n=r.response;if(!n||n.error)return e(n&&n.error?n.error.message:o);t({default:n.url})})),r.upload&&r.upload.addEventListener("progress",(function(t){t.lengthComputable&&(a.uploadTotal=t.total,a.uploaded=t.loaded)}))}},{key:"_sendRequest",value:function(t){var e=new FormData;e.append("upload_preset",o.nr),e.append("folder",this.folder||"/content/articles"),e.append("tags",this.tags||"browser_upload"),e.append("file",t),e.append("upload",t),this.xhr.send(e)}}]),t}()},59940:function(t,e,n){n.d(e,{v:function(){return r}});var r={routePath:"/product/"}}}]);