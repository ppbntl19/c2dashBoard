"use strict";(self["webpackChunkc2_cms_admin"]=self["webpackChunkc2_cms_admin"]||[]).push([[555],{1613:function(e,t,r){r.d(t,{Z:function(){return $}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container"},[r("el-form",{ref:"validateForm",attrs:{model:e.formData,rules:e.rules,"label-width":"140px"}},[r("el-form-item",{attrs:{label:"Name",prop:"name"}},[r("el-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),r("el-form-item",{attrs:{label:"Route",prop:"route"}},[r("el-input",{model:{value:e.formData.route,callback:function(t){e.$set(e.formData,"route",t)},expression:"formData.route"}})],1),r("el-form-item",{attrs:{label:"Category",prop:"category"}},[r("el-select",{attrs:{placeholder:"please choose"},model:{value:e.formData.category,callback:function(t){e.$set(e.formData,"category",t)},expression:"formData.category"}},e._l(e.categoryList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"Product Picture",prop:"pic"}},[r("el-upload",{attrs:{action:"","http-request":e.onUploadStart,"list-type":"picture-card",name:"upload","auto-upload":!0,"file-list":e.uploadFile.list,limit:e.uploadFile.limit,"on-success":e.onUploadChange,"on-remove":e.onRemoveChange,"on-exceed":e.onUploadExceed,drag:"",multiple:"",headers:e.uploadHeaders}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),r("el-form-item",{attrs:{label:"Home Recommended",prop:"recommend"}},[r("el-switch",{model:{value:e.formData.recommend,callback:function(t){e.$set(e.formData,"recommend",t)},expression:"formData.recommend"}}),e._v(" "+e._s(e.formData.recommend?"On":"Disable")+" ")],1),r("el-form-item",{attrs:{label:"Status",prop:"status"}},[r("el-switch",{model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}}),e._v(" "+e._s(e.formData.status?"On":"Disable")+" ")],1),r("el-form-item",{attrs:{label:"About(SEO)",prop:"intro"}},[r("el-input",{model:{value:e.formData.intro,callback:function(t){e.$set(e.formData,"intro",t)},expression:"formData.intro"}})],1),r("el-form-item",{attrs:{label:"Content",prop:"content"}},[r("ckeditor",{attrs:{editor:e.editor},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1),r("div",{staticClass:"fixed--footer"},[r("el-button",{attrs:{type:"primary",id:"editor"},on:{click:function(t){return e.submitForm("validateForm")}}},[e._v("Submit")]),r("el-button",{on:{click:function(t){return e.resetForm("validateForm")}}},[e._v("Reset")])],1)],1)},o=[],n=(r(7658),r(9940)),s=r(1787),i=r(5864),l=(r(2325),r(1836)),u=r(5334),d=r(2002),c=r.n(d),p=r(6480);const m=(0,l.LP)(),f=`Bearer ${m}`,{routePath:h}=n.config;var g={name:"ProductCreateUpdate",components:{},filters:{},props:{type:{type:String,default:function(){return"create"}}},data(){return{loading:!1,querys:{id:""},formData:{id:"",name:"",route:"",category:"",pic:"",recommend:!0,intro:"",content:"",status:!0,createdBy:this.$store.state.user.userInfo.id},rules:{name:[{required:!0,message:"Please enter a name",trigger:"blur"}],route:[{required:!0,message:"Please enter a Description(Slug URL)",trigger:"blur"},{min:1,max:100,message:"1 to 100 characters long",trigger:"blur"}],category:[{required:!0,message:"Please select a type",trigger:"change"}],pic:[{required:!0,message:"Please upload a picture",trigger:"change"}],content:[{required:!0,message:"Please enter details",trigger:"change"}]},categoryList:[],uploadHeaders:{Authorization:f},uploadFile:{list:[],limit:1},editor:c(),editorConfig:{htmlSupport:{allow:[{name:/.*/,attributes:!0,classes:!0,styles:!0,scripts:!0}]},extraPlugins:[y]}}},watch:{},created(){this.getQuery(),this.getCategoryList()},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return!1;this.loading=!0,"update"===this.type?this.putUpdate():this.postCreate()}))},resetForm(e){this.$refs[e].resetFields()},getQuery(){const e=this.$route.query||{};if(this.querys=e,"update"===this.type){if(!e.id)return void this.$router.push("list");this.getDetail()}},onChoiceCategory(e){console.log("onChoiceCategory",e)},onResetCategory(){this.formData.category=[]},onUploadChange(e){console.log(e),this.formData.pic=e.path},onUploadStart(e){(0,u.I)(e.file,"banner","banner").then((e=>{this.formData.pic=e.url}))},onRemoveChange(e){e.response;this.uploadFile.list=[],this.formData.pic=""},onUploadExceed(){this.$message({message:"Exceeded upload quantity",type:"error"}),console.log("onUploadExceed")},postCreate(){(0,s.Ue)(this.formData).then((()=>{this.loading=!1,this.$message({message:"Congratulations, the operation was successful",type:"success",duration:1e3}),setTimeout((()=>{this.$router.push(`${h}list`)}),1e3)})).finally((()=>{this.loading=!1}))},putUpdate(){(0,s.Vx)(this.formData).then((()=>{this.loading=!1,this.$message({message:"Congratulations, the operation was successful",type:"success",duration:1e3}),setTimeout((()=>{this.$router.push(`${h}list`)}),1e3)})).finally((()=>{this.loading=!1}))},getDetail(){this.loading=!0,(0,s.Nm)(this.querys.id).then((e=>{this.loading=!1;const{pic:t}=e;t&&t&&this.uploadFile.list.push({name:t,url:t}),this.formData=e})).finally((()=>{this.loading=!1}))},getCategoryList(){(0,i.mE)().then((e=>{this.categoryList=e.results||[]})).finally((()=>{this.loading=!1}))}}};function y(e){e.plugins.get("FileRepository").createUploadAdapter=e=>new p.i(e,"home_about","C2_home_About")}var b=g,v=r(1001),D=(0,v.Z)(b,a,o,!1,null,null,null),$=D.exports},555:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("create-update",{attrs:{type:e.type}})],1)},o=[],n=r(1613),s={name:"CreateAbout",components:{CreateUpdate:n.Z},data(){return{type:"create"}}},i=s,l=r(1001),u=(0,l.Z)(i,a,o,!1,null,null,null),d=u.exports},5334:function(e,t,r){r.d(t,{I:function(){return o}});var a=r(2325);const o=async(e,t,r)=>{var o=new FormData;o.append("upload_preset",a.nr),o.append("folder",r||"/content/articles"),o.append("tags",t||"browser_upload"),o.append("file",e);var n=`${a.lQ}/${a.Ke}/upload`;try{const e=await fetch(n,{method:"POST",body:o});return await e.json()}catch(s){return console.error(s)}}},5864:function(e,t,r){r.d(t,{Nm:function(){return i},Od:function(){return s},Ue:function(){return l},Vx:function(){return u},mE:function(){return n}});var a=r(4471);const o="/product-categories/";function n(e){return(0,a.Z)({url:`${o}`,method:"get",params:e})}function s(e){return(0,a.Z)({url:`${o}`,method:"delete",data:e})}function i(e){return(0,a.Z)({url:`${o+e}`,method:"get"})}function l(e){return(0,a.Z)({url:`${o}`,method:"post",data:e})}function u(e){return(0,a.Z)({url:`${o+e.id}`,method:"put",data:e})}},1787:function(e,t,r){r.d(t,{Nm:function(){return i},Od:function(){return s},Ue:function(){return l},Vx:function(){return u},mE:function(){return n}});var a=r(4471);const o="/products/";function n(e){return(0,a.Z)({url:`${o}`,method:"get",params:e})}function s(e){return(0,a.Z)({url:`${o}`,method:"delete",data:e})}function i(e){return(0,a.Z)({url:`${o+e}`,method:"get"})}function l(e){return(0,a.Z)({url:`${o}`,method:"post",data:e})}function u(e){return(0,a.Z)({url:`${o+e.id}`,method:"put",data:e})}},6480:function(e,t,r){r.d(t,{i:function(){return o}});var a=r(2325);class o{constructor(e,t,r,a){this.loader=e,this.folder=t,this.tags=r,a&&(this.sizes=a)}upload(){return this.loader.file.then((e=>new Promise(((t,r)=>{this._initRequest(),this._initListeners(t,r,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;var t=`${a.lQ}/${a.Ke}/upload`;e.open("POST",t,!0),e.responseType="json"}_initListeners(e,t,r){const a=this.xhr,o=this.loader,n=`Couldn't upload file: ${r.name}.`;a.addEventListener("error",(()=>t(n))),a.addEventListener("abort",(()=>t())),a.addEventListener("load",(()=>{const r=a.response;if(!r||r.error)return t(r&&r.error?r.error.message:n);e({default:r.url})})),a.upload&&a.upload.addEventListener("progress",(e=>{e.lengthComputable&&(o.uploadTotal=e.total,o.uploaded=e.loaded)}))}_sendRequest(e){const t=new FormData;t.append("upload_preset",a.nr),t.append("folder",this.folder||"/content/articles"),t.append("tags",this.tags||"browser_upload"),t.append("file",e),t.append("upload",e),this.xhr.send(t)}}},9940:function(e,t,r){r.d(t,{config:function(){return a}});const a={routePath:"/product/"}}}]);